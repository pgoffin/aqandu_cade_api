<!DOCTYPE html>
<html lang="en">
<head>
    <title>AirU - Testing Webpage</title>
</head>

<body>

Search By MAC:<br> <input type="text" id="search_form_input">

<div id="dbtable"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<script>
$("#search_form_input").keyup(function(){
    console.log("Inside search bar keyup function...");
    var text = $(this).val();

    $.ajax({
      url: "../dbquery",
      type: "get",
      data: {jsdata: text},
      success: function(response) {
        $("#dbtable").html(response);
      },
      error: function(xhr) {
        console.log("ERROR in keyup");
        console.log(xhr);
      }
    });
});
</script>

<script type="text/javascript">
    window.onload = setupRefresh;
    function setupRefresh()
    {
        console.log("Setting refresh...");
        setInterval("refreshBlock();",3000);
    }

    function refreshBlock()
    {
        console.log("Inside refresh block...");
        var inbox = document.getElementById("search_form_input");
        var text = inbox.value;
        if (text.length === 0){
            $.ajax({
                url: "../dbquery",
                type: "get",
                data: {jsdata: text},
                success: function(response) {
                $("#dbtable").html(response);
                },
                error: function(xhr) {
                    console.log("ERROR in refresh block...");
                    console.log(xhr);
                }
            });
        }
    }
  </script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
    $(document).ready(function()
    {
        var inbox = document.getElementById("search_form_input");
        var text = inbox.value;
        if (text.length === 0){
            $.ajax({
                url: "../dbquery",
                type: "get",
                data: {jsdata: text},
                success: function(response) {
                $("#dbtable").html(response);
                },
                error: function(xhr) {
                    console.log("ERROR in first print");
                    console.log(xhr);
                }
            });
        }
    });
  </script>

</body>

</html>